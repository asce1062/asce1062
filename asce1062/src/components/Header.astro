---
/**
 * Header Component
 *
 * Header with breadcrumb navigation, theme switcher, search button,
 * and collapsible main navigation.
 */
import ThemeSwitcher from "@/components/ThemeSwitcher.astro";
import CollapsibleNav from "@/components/CollapsibleNav.astro";
import { mainNavigation, siteMetadata } from "@/data/navigation";

const url = new URL(Astro.url.pathname, Astro.site);
const link = url.pathname.split("/").filter((i) => i);
const currentPath = Astro.url.pathname;
const isSearchPage = currentPath === "/search" || currentPath === "/search/";
---

<header>
	{/* Top bar: Breadcrumb path + Theme/Search controls */}
	<div id="navigation" class="mb-3">
		<div class="float-right flex flex-col gap-2">
			<ThemeSwitcher default="dark" />
			{
				!isSearchPage && (
					<button
						id="open-floating-search"
						type="button"
						class="float-right h-7 w-7 md:h-8 md:w-8 rounded-md transition-all duration-100"
						aria-label="Open search">
						<i class="icon-search-heart" />
					</button>
				)
			}
		</div>

		{/* Breadcrumb path display */}
		<b>
			<span>
				~/
				<span class="group">
					<a class="no-underline group-hover:bg-primary group-hover:text-primary-content transition-colors" href="/">
						home
					</a> / <a
						class="no-underline group-hover:bg-primary group-hover:text-primary-content transition-colors"
						href="/">
						alex
					</a>
				</span>
				{
					link ? (
						<span>
							{link.map((data, index) => (
								<span>
									/
									<a class="inline! no-underline" href={`/${link.slice(0, index + 1).join("/")}`}>
										{data}
									</a>
								</span>
							))}
						</span>
					) : (
						<span> / </span>
					)
				}
			</span>
		</b>
	</div>
	<h1>{siteMetadata.greeting}</h1>
	<hr class="w-full h-[1.875px] my-4 border-0 bg-base-300" />
	<div class="flex flex-col gap-6 min-h-12">
		<CollapsibleNav items={mainNavigation} currentPath={currentPath} id="main-nav" />
	</div>
	<hr class="w-full h-[1.25px] my-4 border-0 bg-base-300" />
</header>
