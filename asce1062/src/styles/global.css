@import "tailwindcss";
@import "./theme.css";

/*
============================================
Custom Utilities
============================================
*/

@utility content-prose {
	max-width: 55rem;
}

@utility table-of-contents {
	& ul {
		@apply list-disc ml-2 space-y-4 list-outside pl-5;
	}

	& ul ul {
		@apply ml-8 my-4;
	}

	& li {
		@apply my-4;
	}

	& a {
		@apply underline decoration-dashed underline-offset-8;
	}

	& summary {
		@apply cursor-pointer;
	}
}

@utility btn {
	padding: 0.75rem 1.5rem;
	border-radius: 0rem;
	font-family: "0xProto", monospace;
	font-size: 0.875rem;
	font-weight: 600;
	font-style: italic;
	cursor: pointer;
	transition:
		background-color 0.2s,
		translate 0.1s;
	background-color: var(--btn-bg);

	&:active {
		--btn-bg: var(--btn-color, var(--btn-hover-mix));
		translate: 0 0.5px;
	}

	@media (hover: hover) {
		&:hover {
			--btn-bg: var(--btn-color);
		}

		@supports (color: color-mix(in oklab, red, red)) {
			&:hover {
				--btn-bg: color-mix(in oklab, var(--btn-color), var(--btn-hover-mix) 7%);
			}
		}
	}
}

@utility input-base {
	@apply border focus:outline focus:outline-2 focus:outline-offset-2;
	background-color: var(--color-base-100);
	border-color: var(--color-base-300);

	&::placeholder {
		color: var(--color-neutral-content);
	}
}

@layer base {
	/*
  ============================================
  Custom Font Faces
  ============================================
  */

	@font-face {
		font-family: "0xProto";
		src:
			url("/fonts/0xProto/0xProto-Regular.woff2") format("woff2"),
			url("/fonts/0xProto/0xProto-Regular.otf") format("opentype"),
			url("/fonts/0xProto/0xProto-Regular.ttf") format("truetype");
		font-weight: 400;
		font-style: normal;
		font-display: swap;
	}

	@font-face {
		font-family: "0xProto";
		src:
			url("/fonts/0xProto/0xProto-Bold.woff2") format("woff2"),
			url("/fonts/0xProto/0xProto-Bold.otf") format("opentype"),
			url("/fonts/0xProto/0xProto-Bold.ttf") format("truetype");
		font-weight: 700;
		font-style: normal;
		font-display: swap;
	}

	@font-face {
		font-family: "0xProto";
		src:
			url("/fonts/0xProto/0xProto-Italic.woff2") format("woff2"),
			url("/fonts/0xProto/0xProto-Italic.otf") format("opentype"),
			url("/fonts/0xProto/0xProto-Italic.ttf") format("truetype");
		font-weight: 400;
		font-style: italic;
		font-display: swap;
	}

	@font-face {
		font-family: "uni0553";
		src: url("/fonts/uni0553/uni0553.eot");
		src:
			url("/fonts/uni0553/uni0553.eot?#iefix") format("embedded-opentype"),
			url("/fonts/uni0553/uni0553.woff") format("woff"),
			url("/fonts/uni0553/uni0553.ttf") format("truetype"),
			url("/fonts/uni0553/uni0553.svg#uni_05_53regular") format("svg");
		font-weight: normal;
		font-style: normal;
		font-display: swap; /* Show fallback font while loading */
	}

	/*
  ============================================
  Global Selections & Body
  ============================================
  */

	::selection {
		background-color: var(--color-info);
		color: var(--color-info-content);
	}

	/*
  ============================================
  Dark Mode Transitions
  ============================================
  */

	html {
		transition:
			background-color 0.3s ease,
			color 0.3s ease;
	}

	* {
		transition:
			background-color 0.2s ease,
			border-color 0.2s ease,
			color 0.2s ease;
	}

	/* Disable transitions for elements that shouldn't animate */
	*:where([class*="transition-"], [class*="duration-"], [class*="animate-"], img, video, iframe, canvas, svg) {
		transition: none;
	}

	/* Respect prefers-reduced-motion */
	@media (prefers-reduced-motion: reduce) {
		html,
		* {
			transition: none !important;
		}
	}

	body {
		margin: 0;
		font-family: "0xProto", monospace;
		background-color: var(--color-base-100);
		color: var(--color-base-content);
	}

	/*
  ============================================
  Base Typography
  ============================================
  */

	/*
	* Scroll margin for anchor links
	* For sticky TOC + progress bar
	*/
	h1,
	h2,
	h3,
	h4,
	h5,
	h6 {
		scroll-margin-top: 10rem;
	}

	h1,
	h2,
	h3 {
		font-weight: 700;
	}

	h4,
	h5,
	h6 {
		font-weight: 600;
	}

	h1 {
		font-size: 2.125em;
	}

	h2 {
		font-size: 1.4em;
		margin-bottom: 0.83em;
	}

	p {
		margin-top: 1em;
		margin-bottom: 1em;
	}

	b {
		color: var(--color-warning);
		font-weight: 700;
	}

	a {
		text-decoration: underline;
	}

	/*
  ============================================
  Layout Elements
  ============================================
  */

	header {
		position: relative;
	}

	footer {
		text-align: center;
	}

	/*
  ============================================
  Icon Font Styles
  ============================================
  */

	[class^="icon-"],
	[class*=" icon-"] {
		text-decoration: none;
	}

	.icon {
		text-decoration: none;
		/* Accessibility: Ensure minimum 48x48px tap target */
		display: inline-flex;
		align-items: center;
		justify-content: center;
		min-width: 48px;
		min-height: 48px;
		padding: 8px;
	}

	/*
  ============================================
  Responsive Typography
  ============================================
  */

	@media screen and (width < 640px) {
		p,
		ul {
			font-size: 14px;
		}
	}
}

@layer components {
	/*
  ============================================
  Component Typography
  ============================================
  */

	h1 {
		@apply text-2xl transition-all duration-100 md:text-3xl;
		color: var(--color-base-content);
	}

	h2 {
		@apply text-xl transition-all duration-100 md:text-2xl;
	}

	h3 {
		@apply text-base transition-all duration-100 md:text-lg;
	}

	p:not(blockquote p),
	ul,
	span,
	div {
		color: var(--color-base-content);
	}

	h2,
	h4,
	a,
	b {
		color: var(--color-warning);
	}

	/*
  ============================================
  Lists
  ============================================
  */

	ul {
		@apply list-disc list-inside;
	}

	ol:not(.relative):not(.footnotes ol):not(.pagefind-ui__results) {
		@apply list-decimal ml-14;
	}

	li {
		@apply my-1;
	}

	/*
  ============================================
  Checkboxes (icon-square / icon-check-square)
  ============================================
  */

	input[type="checkbox"] {
		appearance: none;
		-webkit-appearance: none;
		width: 1em;
		height: 1em;
		margin: 0 0.35em 0 0;
		padding: 0;
		vertical-align: -0.1em;
		display: inline-block;
		font-family: "icomoon" !important;
		font-size: 1em;
		line-height: 1;
		border: none;
		background: none;
	}

	/* Unchecked: icon-square (\e9aa) */
	input[type="checkbox"]::before {
		content: "\e9aa";
	}

	/* Checked: icon-check-square (\f0ed) */
	input[type="checkbox"]:checked::before {
		content: "\f0ed";
	}

	/*
  ============================================
  Interactive Elements
  ============================================
  */

	a {
		@apply underline-offset-4 hover:no-underline inline-block;
	}

	a:hover {
		background-color: var(--color-primary);
		color: var(--color-primary-content);
	}

	a:active {
		translate: 0 0.5px;
	}

	input {
		@apply my-4 p-2 font-normal;
		background-color: var(--color-base-100);
	}

	kbd {
		@apply inline-block px-2 py-1 text-xs border;
		background-color: var(--color-neutral);
		border-color: var(--color-secondary);
		color: var(--color-neutral-content);
	}

	/*
  ============================================
  Content Blocks
  ============================================
  */

	blockquote {
		@apply border-l-4 pl-4 pr-2 italic my-4 py-2;
		border-color: var(--color-warning);
		background-color: color-mix(in oklab, var(--color-primary), transparent 80%);
		color: var(--color-base-content);
	}

	blockquote ol {
		@apply list-decimal ml-6;
		color: var(--color-primary-content);
	}

	details:not(.table-of-contents details) > :nth-child(n + 2),
	#expand-content p {
		@apply pl-4 border-l p-2;
		border-color: var(--color-warning);
	}

	/*
  ============================================
  Code Blocks & Syntax Highlighting
  ============================================
  */

	code:not(pre code) {
		@apply px-1 py-0.5 font-normal text-sm;
		background-color: var(--color-neutral);
		color: var(--color-neutral-content);
	}

	code {
		@apply text-xs! md:text-sm!;
	}

	pre {
		@apply px-0!;
		@apply border;
		border-color: var(--color-base-300);
	}

	code {
		@apply text-sm md:text-base leading-loose!;
	}

	pre > code {
		counter-reset: line;
	}

	pre,
	code,
	figure {
		@apply overflow-x-auto px-2;
	}

	/* Shiki Theme Support */
	code[data-theme*=" "],
	code[data-theme*=" "] span {
		color: var(--shiki-light);
		background-color: var(--shiki-light-bg);
	}

	@media (prefers-color-scheme: dark) {
		html[data-theme="dark"] code[data-theme*=" "],
		html[data-theme="dark"] code[data-theme*=" "] span {
			color: var(--shiki-dark);
			background-color: var(--shiki-dark-bg);
		}
	}

	/* Line Numbers */
	code[data-line-numbers] {
		counter-reset: line;
	}

	code[data-line-numbers] > [data-line]::before {
		counter-increment: line;
		content: counter(line);
		@apply inline-block w-4 mr-4 text-right text-gray-500;
	}

	pre [data-line] {
		@apply px-4 border-l-2 border-l-transparent;
	}

	/* Code Highlighting */
	[data-highlighted-line] {
		background: rgba(200, 200, 255, 0.1);
		@apply border-l-blue-400;
	}

	[data-highlighted-chars] {
		@apply bg-zinc-600/50;
		box-shadow: 0 0 0 4px rgb(82 82 91 / 0.5);
	}

	[data-chars-id] {
		@apply shadow-none p-1 border-b-2;
	}

	[data-chars-id] span {
		@apply text-inherit!;
	}

	[data-chars-id="v"] {
		@apply text-pink-300! bg-rose-800/50 border-b-pink-600 font-bold;
	}

	[data-chars-id="s"] {
		@apply text-yellow-300! bg-yellow-800/50 border-b-yellow-600 font-bold;
	}

	[data-chars-id="i"] {
		@apply text-purple-200! bg-purple-800/50 border-b-purple-600 font-bold;
	}

	/* Code Block Titles */
	[data-rehype-pretty-code-title] {
		@apply py-2 px-4 font-semibold text-sm border;
		background-color: var(--color-base-200);
		color: var(--color-base-content);
		border-color: var(--color-base-300);
	}

	figcaption + pre {
		@apply rounded-t-none!;
	}

	figure {
		@apply mb-6 mt-1;
	}
}

/*
============================================
Global Utility Styles
============================================
*/

.footnotes {
	margin-top: 2rem;
	padding-bottom: 5.5vh;
	@apply max-w-220 px-4 sm:px-6 md:px-8 mx-auto;
	color: var(--color-base-content);
}

/* Ensure iframe displays properly */
iframe {
	color-scheme: auto;
	display: block;
}

#ascii-404 {
	@apply text-center;
	display: inline-block;
}

/*
============================================
Share Notification (Global)
============================================
*/
.share-notification {
	position: fixed;
	top: 2rem;
	right: 2rem;
	display: flex;
	align-items: center;
	gap: 1rem;
	padding: 1rem 1.5rem;
	background-color: var(--color-success);
	border-radius: 0;
	box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
	font-weight: 600;
	z-index: 1000;
	animation: slideInFromRight 0.3s ease-out;
}

.share-notification span {
	color: var(--color-success-content);
}

.share-notification.hidden {
	display: none;
}

.share-notification.fadeOut {
	animation: slideOutToRight 0.3s ease-out forwards;
}

.close-btn {
	background: none;
	border: none;
	color: var(--color-base-100);
	cursor: pointer;
	padding: 0.25rem;
	display: flex;
	align-items: center;
	justify-content: center;
	transition: opacity 0.2s;
}

.close-btn:hover {
	opacity: 0.7;
}

@keyframes slideInFromRight {
	from {
		transform: translateX(400px);
		opacity: 0;
	}
	to {
		transform: translateX(0);
		opacity: 1;
	}
}

@keyframes slideOutToRight {
	from {
		transform: translateX(0);
		opacity: 1;
	}
	to {
		transform: translateX(400px);
		opacity: 0;
	}
}

@media (max-width: 768px) {
	.share-notification {
		top: 1rem;
		right: 1rem;
		padding: 0.75rem 1rem;
		font-size: 0.875rem;
		gap: 0.75rem;
	}

	.close-btn {
		font-size: 0.875rem;
	}
}

@view-transition {
	navigation: auto;
}

.btn-primary {
	--btn-color: var(--color-primary);
	--btn-hover-mix: var(--color-base-200);
	--btn-bg: var(--btn-color);

	@apply btn;
	color: var(--color-primary-content);
}

.btn-secondary {
	--btn-color: var(--color-secondary);
	--btn-hover-mix: var(--color-base-200);
	--btn-bg: var(--btn-color);

	@apply btn;
	color: var(--color-secondary-content);
}

.btn-neutral {
	--btn-color: var(--color-neutral);
	--btn-hover-mix: var(--color-base-200);
	--btn-bg: var(--btn-color);

	@apply btn;
	color: var(--color-neutral-content);
}

.btn-accent {
	--btn-color: var(--color-accent);
	--btn-hover-mix: var(--color-base-200);
	--btn-bg: var(--btn-color);

	@apply btn;
	color: var(--color-accent-content);
}

.btn-info {
	--btn-color: var(--color-info);
	--btn-hover-mix: var(--color-base-200);
	--btn-bg: var(--btn-color);

	@apply btn;
	color: var(--color-info-content);
}

.btn-success {
	--btn-color: var(--color-success);
	--btn-hover-mix: var(--color-base-200);
	--btn-bg: var(--btn-color);

	@apply btn;
	color: var(--color-success-content);
}

.btn-warning {
	--btn-color: var(--color-warning);
	--btn-hover-mix: var(--color-base-200);
	--btn-bg: var(--btn-color);

	@apply btn;
	color: var(--color-warning-content);
}

.btn-error {
	--btn-color: var(--color-error);
	--btn-hover-mix: var(--color-base-200);
	--btn-bg: var(--btn-color);

	@apply btn;
	color: var(--color-error-content);
}

.link-action {
	display: inline-flex;
	align-items: center;
	gap: 0.5rem;

	padding: 0.5rem 0.75rem;
	border-radius: 0rem;
	font-family: "0xProto", monospace;
	font-weight: 500;
	font-style: italic;
	text-decoration: none;
	cursor: pointer;

	background-color: var(--color-neutral);
	color: var(--color-neutral-content);
	border: 1px solid var(--color-neutral-content);

	transition:
		background-color 0.2s,
		color 0.2s,
		border-color 0.2s;
}

@media (hover: hover) {
	.link-action:hover,
	.link-action:active {
		background-color: var(--color-base-100);
		color: var(--color-base-content);
		border-color: var(--color-base-300);
	}
}

.link-action:active {
	translate: 0 0.5px;
}

.link-action:focus-visible {
	outline: 2px solid var(--color-accent);
	outline-offset: 2px;
}

.link-action--primary {
	background-color: color-mix(in oklab, var(--color-primary) 99%, transparent);
	border-color: var(--color-neutral-content);
	color: var(--color-primary-content);
}

.link-action--secondary {
	background-color: color-mix(in oklab, var(--color-secondary) 99%, transparent);
	border-color: var(--color-neutral-content);
	color: var(--color-secondary-content);
}

.link-action--accent {
	background-color: color-mix(in oklab, var(--color-accent) 99%, transparent);
	border-color: var(--color-neutral-content);
	color: var(--color-accent-content);
}

.link-action--success {
	background-color: color-mix(in oklab, var(--color-success) 99%, transparent);
	border-color: var(--color-neutral-content);
	color: var(--color-success-content);
}

.link-action--neutral {
	background-color: color-mix(in oklab, var(--color-neutral) 99%, transparent);
	border-color: var(--color-neutral-content);
	color: var(--color-neutral-content);
}

.link-action--info {
	background-color: color-mix(in oklab, var(--color-info) 99%, transparent);
	border-color: var(--color-neutral-content);
	color: var(--color-info-content);
}

.link-action--warning {
	background-color: color-mix(in oklab, var(--color-warning) 99%, transparent);
	border-color: var(--color-neutral-content);
	color: var(--color-warning-content);
}

.link-action--error {
	background-color: color-mix(in oklab, var(--color-error) 99%, transparent);
	border-color: var(--color-neutral-content);
	color: var(--color-error-content);
}

/* Nostalgic Effects */
.blink {
	animation: blink-animation 1s steps(2, start) infinite;
}

@keyframes blink-animation {
	to {
		visibility: hidden;
	}
}

marquee {
	display: inline-block;
	vertical-align: middle;
	width: auto;
	height: auto;
}

.faded-text {
	background: linear-gradient(
		90deg,
		var(--color-primary),
		var(--color-secondary),
		var(--color-accent),
		var(--color-neutral),
		var(--color-info),
		var(--color-success),
		var(--color-warning),
		var(--color-error)
	);
	background-size: 200% 100%;
	-webkit-background-clip: text;
	-webkit-text-fill-color: transparent;
	background-clip: text;
	animation: gradient-shift 5s ease-in-out infinite;
}

@keyframes gradient-shift {
	0%,
	100% {
		background-position: 0% 50%;
	}
	50% {
		background-position: 100% 50%;
	}
}

.input-allowed {
	@apply input-base;
	color: var(--color-base-content);
}

.input-allowed:focus {
	outline-color: var(--color-success);
}

.input-honeypot {
	@apply input-base;
	color: var(--color-neutral-content);
	background-color: color-mix(in oklab, var(--color-warning), transparent 80%) !important;
}

.input-honeypot:focus {
	outline-color: var(--color-error);
}

.input-honeypot:focus {
	animation: shake 0.3s linear;
}
